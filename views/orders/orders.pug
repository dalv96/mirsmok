extend ../basic
append head
    link(rel='stylesheet' href='/public/css/order.css')
    script(src='/public/js/order.js')
append content
    -function dateToStr(value) {
    -    var year = value.getFullYear();
    -    var month = value.getMonth() + 1;
    -    if(month < 10) {
    -        month = '0' + month;
    -    }
    -    var day = value.getDate();
    -    if(day < 10) {
    -        day = '0' + day;
    -    }
    -    return  day + '.' + month + '.' + year;
    -}
    if(success) 
        script.
            var notyf = new Notyf();
            notyf.confirm('Заявка была успешно сохранена!');
    .pagers
        div(aria-label="Page navigation example")
            ul.pagination
                li.page-item
                    a(class="page-link" onclick='return setAttr("page","1")' aria-label="Previous")
                        span(aria-hidden="true") Начало
                        span(class="sr-only") Previous 
                -var prev = (nowPage == 1)?'page-item disabled':'page-item';
                li(class=prev)
                    -var previosPage = nowPage - 1;
                    a(class="page-link" onclick='return changePage("'+prev+'",' + previosPage +')' aria-label="Previous")
                        span(aria-hidden="true") &laquo; Пред.
                        span(class="sr-only") Previous 
                -nowPage = +nowPage;
                -var end = pages;
                -var start = 1;
                
                if(pages <= 6)
                    -start = 1;
                    -end = pages;
                else
                    if(nowPage <= 3)
                        -start = 1;
                        -end = 6
                    else
                        -start = nowPage - 2;
                        -end = ((nowPage + 3) <= pages)?(nowPage + 3):pages;
                        
                -for(var i=start; i<=end; i++)
                    if(nowPage == i)
                        li(class="page-item active")
                            a(class="page-link" onclick='return setAttr("page","' + i + '")')= i
                    else
                        li(class="page-item")
                            a(class="page-link" onclick='return setAttr("page","' + i + '")')= i
                
                -var next = (nowPage == pages)?'page-item disabled':'page-item';
                li(class=next)
                    -var nextPage = nowPage+1;
                    a(class="page-link" onclick='return changePage("' + next + '",' + nextPage + ')' aria-label="Next")
                        span(aria-hidden="true") След. &raquo;
                        span(class="sr-only") Next
                li.page-item
                    a(class="page-link" onclick='return setAttr("page","' + pages + '")' aria-label="Previous")
                        span(aria-hidden="true") Конец
                        span(class="sr-only") Previous
    .table-responsive.container-fluid
        h3 Заявки для проработки
        table.table.table-hover#myTable
            thead
                tr
                    th Номер
                    th Дата инициации
                    th Дата выезда
                    th Инициатор
                    th Тип проведенных работ
                    th Ф.И.О. клиента
            tbody
                each order in orders
                    tr(onclick="location = '/collector/orders/" + order.id + "'").item
                        td №#{order.id}
                        td= dateToStr(order.info.dateInit)
                        td= dateToStr(order.info.dateEvent)
                        if(order.author)
                            td #{order.author.fullName} (#{order.author.city.name})
                        else
                            td Автоимпорт (Неопределён)
                        if(order.type == 0)
                            td Инсталляция
                        else
                            td Ремонт
                        td= order.info.nameAbon
    .empty-elemnt
